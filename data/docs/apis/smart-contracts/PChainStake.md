---
title: PChainStake
search:
  boost: 0.5
---

<!-- This is an autogenerated file. Do not edit! -->

# `PChainStake` { #ct_pchainstake }

<div class="api-node-source" markdown>
[Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/staking/implementation/PChainStake.sol) | Inherits from [IPChainVotePower](./IPChainVotePower.md), [CheckPointable](./CheckPointable.md)
</div>

<div class="api-node-internal" markdown>

Helper contract handling all the vote power and balance functionality for the [`PChainStakeMirror`](./PChainStakeMirror.md).

</div>

<div class="api-node-type" markdown>

## Functions

<div class="api-node" markdown>

### `balanceHistoryCleanup` { #fn_balancehistorycleanup_f0e292c9 }

<div class="api-node-source" markdown>
Defined in `CheckPointable` ([Docs](./CheckPointable.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/CheckPointable.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function balanceHistoryCleanup(
    address _owner,
    uint256 _count
) external returns (
    uint256);
```

Delete balance checkpoints that expired (i.e. are before `cleanupBlockNumber`).
Method can only be called from the [`cleanerContract`](#va_cleanercontract) (which may be a proxy to external cleaners).

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owner` | `address` | balance owner account address |
| `_count` | `uint256` | maximum number of checkpoints to delete |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | the number of checkpoints deleted |
</div>
</div>

<div class="api-node" markdown>

### `batchVotePowerOfAt` { #fn_batchvotepowerofat_a9e70199 }

<div class="api-node-source" markdown>
Defined in `PChainStake` ([Docs](./PChainStake.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/staking/implementation/PChainStake.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function batchVotePowerOfAt(
    bytes20[] _owners,
    uint256 _blockNumber
) external view returns (
    uint256[] _votePowers);
```

Return vote powers for several node ids in a batch.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owners` | `bytes20[]` |  |
| `_blockNumber` | `uint256` | The block number at which to fetch. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| `_votePowers` | `uint256[]` | A list of vote powers. |
</div>
</div>

<div class="api-node" markdown>

### `stakesHistoryCleanup` { #fn_stakeshistorycleanup_c13edf70 }

<div class="api-node-source" markdown>
Defined in `PChainStake` ([Docs](./PChainStake.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/staking/implementation/PChainStake.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function stakesHistoryCleanup(
    address _owner,
    uint256 _count
) external returns (
    uint256);
```

Delete stakes checkpoints that expired (i.e. are before `cleanupBlockNumber`).
Method can only be called from the [`cleanerContract`](#va_cleanercontract) (which may be a proxy to external cleaners).

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owner` | `address` | Balance owner account address. |
| `_count` | `uint256` | Maximum number of checkpoints to delete. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | Number of deleted checkpoints. |
</div>
</div>

<div class="api-node" markdown>

### `stakesOf` { #fn_stakesof_33b69c4c }

<div class="api-node-source" markdown>
Defined in `PChainStake` ([Docs](./PChainStake.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/staking/implementation/PChainStake.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function stakesOf(
    address _owner
) external view returns (
    bytes20[] _nodeIds,
    uint256[] _amounts);
```

Get the amounts and node ids being staked to by a vote power owner.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owner` | `address` | The address being queried. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| `_nodeIds` | `bytes20[]` | Array of node ids. |
| `_amounts` | `uint256[]` | Array of staked amounts, for each node id. |
</div>
</div>

<div class="api-node" markdown>

### `stakesOfAt` { #fn_stakesofat_4be91f32 }

<div class="api-node-source" markdown>
Defined in `PChainStake` ([Docs](./PChainStake.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/staking/implementation/PChainStake.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function stakesOfAt(
    address _owner,
    uint256 _blockNumber
) external view returns (
    bytes20[] _nodeIds,
    uint256[] _amounts);
```

Get the amounts and node ids being staked to by a vote power owner,
at a given block.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owner` | `address` | The address being queried. |
| `_blockNumber` | `uint256` | The block number being queried. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| `_nodeIds` | `bytes20[]` | Array of node ids. |
| `_amounts` | `uint256[]` | Array of staked amounts, for each node id. |
</div>
</div>

<div class="api-node" markdown>

### `totalSupplyCacheCleanup` { #fn_totalsupplycachecleanup_43ea370b }

<div class="api-node-source" markdown>
Defined in `CheckPointable` ([Docs](./CheckPointable.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/CheckPointable.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function totalSupplyCacheCleanup(
    uint256 _blockNumber
) external returns (
    uint256);
```

Delete total supply cache entry that expired (i.e. is before `cleanupBlockNumber`).
Method can only be called from the [`cleanerContract`](#va_cleanercontract) (which may be a proxy to external cleaners).

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_blockNumber` | `uint256` | the block number for which total supply value was cached |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | the number of cache entries deleted (always 0 or 1) |
</div>
</div>

<div class="api-node" markdown>

### `totalSupplyHistoryCleanup` { #fn_totalsupplyhistorycleanup_f62f8f3a }

<div class="api-node-source" markdown>
Defined in `CheckPointable` ([Docs](./CheckPointable.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/CheckPointable.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function totalSupplyHistoryCleanup(
    uint256 _count
) external returns (
    uint256);
```

Delete total supply checkpoints that expired (i.e. are before `cleanupBlockNumber`).
Method can only be called from the [`cleanerContract`](#va_cleanercontract) (which may be a proxy to external cleaners).

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_count` | `uint256` | maximum number of checkpoints to delete |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | the number of checkpoints deleted |
</div>
</div>

<div class="api-node" markdown>

### `totalVotePower` { #fn_totalvotepower_f5f3d4f7 }

<div class="api-node-source" markdown>
Defined in `PChainStake` ([Docs](./PChainStake.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/staking/implementation/PChainStake.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function totalVotePower(
) external view returns (
    uint256);
```

Get the current total vote power.

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | The current total vote power (sum of all accounts' vote powers). |
</div>
</div>

<div class="api-node" markdown>

### `totalVotePowerAt` { #fn_totalvotepowerat_3e5aa26a }

<div class="api-node-source" markdown>
Defined in `PChainStake` ([Docs](./PChainStake.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/staking/implementation/PChainStake.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function totalVotePowerAt(
    uint256 _blockNumber
) external view returns (
    uint256);
```

Get the total vote power at block `_blockNumber`

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_blockNumber` | `uint256` | The block number at which to fetch. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | The total vote power at the block  (sum of all accounts' vote powers). |
</div>
</div>

<div class="api-node" markdown>

### `totalVotePowerAtCached` { #fn_totalvotepoweratcached_caeb942b }

<div class="api-node-source" markdown>
Defined in `PChainStake` ([Docs](./PChainStake.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/staking/implementation/PChainStake.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function totalVotePowerAtCached(
    uint256 _blockNumber
) external returns (
    uint256);
```

Get the total vote power at block `_blockNumber` using cache.
  It tries to read the cached value and if not found, reads the actual value and stores it in cache.
  Can only be used if `_blockNumber` is in the past, otherwise reverts.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_blockNumber` | `uint256` | The block number at which to fetch. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | The total vote power at the block (sum of all accounts' vote powers). |
</div>
</div>

<div class="api-node" markdown>

### `votePowerCacheCleanup` { #fn_votepowercachecleanup_a2e96264 }

<div class="api-node-source" markdown>
Defined in `PChainStake` ([Docs](./PChainStake.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/staking/implementation/PChainStake.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function votePowerCacheCleanup(
    bytes20 _nodeId,
    uint256 _blockNumber
) external returns (
    uint256);
```

Delete vote power cache entry that expired (i.e. is before `cleanupBlockNumber`).
Method can only be called from the [`cleanerContract`](#va_cleanercontract) (which may be a proxy to external cleaners).

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_nodeId` | `bytes20` | vote power node id |
| `_blockNumber` | `uint256` | the block number for which total supply value was cached |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | the number of cache entries deleted (always 0 or 1) |
</div>
</div>

<div class="api-node" markdown>

### `votePowerFromTo` { #fn_votepowerfromto_59c345f5 }

<div class="api-node-source" markdown>
Defined in `PChainStake` ([Docs](./PChainStake.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/staking/implementation/PChainStake.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function votePowerFromTo(
    address _owner,
    bytes20 _nodeId
) external view returns (
    uint256 _votePower);
```

Get current staked vote power from `_owner` staked to `_nodeId`.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owner` | `address` | Address of vote power owner. |
| `_nodeId` | `bytes20` | Node id. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| `_votePower` | `uint256` | The staked vote power. |
</div>
</div>

<div class="api-node" markdown>

### `votePowerFromToAt` { #fn_votepowerfromtoat_1f7ff2c7 }

<div class="api-node-source" markdown>
Defined in `PChainStake` ([Docs](./PChainStake.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/staking/implementation/PChainStake.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function votePowerFromToAt(
    address _owner,
    bytes20 _nodeId,
    uint256 _blockNumber
) external view returns (
    uint256 _votePower);
```

Get current staked vote power from `_owner` staked to `_nodeId` at `_blockNumber`.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owner` | `address` | Address of vote power owner. |
| `_nodeId` | `bytes20` | Node id. |
| `_blockNumber` | `uint256` | The block number at which to fetch. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| `_votePower` | `uint256` | The staked vote power. |
</div>
</div>

<div class="api-node" markdown>

### `votePowerHistoryCleanup` { #fn_votepowerhistorycleanup_119b923a }

<div class="api-node-source" markdown>
Defined in `PChainStake` ([Docs](./PChainStake.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/staking/implementation/PChainStake.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function votePowerHistoryCleanup(
    bytes20 _nodeId,
    uint256 _count
) external returns (
    uint256);
```

Delete vote power checkpoints that expired (i.e. are before `cleanupBlockNumber`).
Method can only be called from the [`cleanerContract`](#va_cleanercontract) (which may be a proxy to external cleaners).

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_nodeId` | `bytes20` | vote power node id |
| `_count` | `uint256` | maximum number of checkpoints to delete |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | the number of checkpoints deleted |
</div>
</div>

<div class="api-node" markdown>

### `votePowerOf` { #fn_votepowerof_b4eb2a81 }

<div class="api-node-source" markdown>
Defined in `PChainStake` ([Docs](./PChainStake.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/staking/implementation/PChainStake.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function votePowerOf(
    bytes20 _nodeId
) external view returns (
    uint256);
```

Get the current vote power of `_nodeId`.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_nodeId` | `bytes20` | The node id to get voting power. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | Current vote power of `_nodeId`. |
</div>
</div>

<div class="api-node" markdown>

### `votePowerOfAt` { #fn_votepowerofat_46431374 }

<div class="api-node-source" markdown>
Defined in `PChainStake` ([Docs](./PChainStake.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/staking/implementation/PChainStake.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function votePowerOfAt(
    bytes20 _nodeId,
    uint256 _blockNumber
) external view returns (
    uint256);
```

Get the vote power of `_nodeId` at block `_blockNumber`

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_nodeId` | `bytes20` | The node id to get voting power. |
| `_blockNumber` | `uint256` | The block number at which to fetch. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | Vote power of `_nodeId` at `_blockNumber`. |
</div>
</div>

<div class="api-node" markdown>

### `votePowerOfAtCached` { #fn_votepowerofatcached_bd61ffee }

<div class="api-node-source" markdown>
Defined in `PChainStake` ([Docs](./PChainStake.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/staking/implementation/PChainStake.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function votePowerOfAtCached(
    bytes20 _nodeId,
    uint256 _blockNumber
) external returns (
    uint256);
```

Get the vote power of `_owner` at block `_blockNumber` using cache.
  It tries to read the cached value and if not found, reads the actual value and stores it in cache.
  Can only be used if _blockNumber is in the past, otherwise reverts.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_nodeId` | `bytes20` |  |
| `_blockNumber` | `uint256` | The block number at which to fetch. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | Vote power of `_owner` at `_blockNumber`. |
</div>
</div>

</div>

<div class="api-node-type" markdown>

## Variables

<div class="api-node" markdown>

### `cleanerContract` { #va_cleanercontract }

<div class="api-node-source" markdown>
Defined in `CheckPointable` ([Docs](./CheckPointable.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/CheckPointable.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
    address cleanerContract
```

Address of the contract that is allowed to call methods for history cleaning.

</div>
</div>

</div>

