---
title: IPChainStakeMirror
search:
  boost: 0.5
---

<!-- This is an autogenerated file. Do not edit! -->

# `IPChainStakeMirror` { #ct_ipchainstakemirror }

<div class="api-node-source" markdown>
[Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainStakeMirror.sol) | Inherits from [IPChainVotePower](./IPChainVotePower.md)
</div>

<div class="api-node-internal" markdown>

Interface for the [`PChainStakeMirror`](./PChainStakeMirror.md) contract.

</div>

<div class="api-node-type" markdown>

## Events

<div class="api-node" markdown>

### `MaxUpdatesPerBlockSet` { #ev_maxupdatesperblockset }

<div class="api-node-source" markdown>
Defined in `IPChainStakeMirror` ([Docs](./IPChainStakeMirror.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainStakeMirror.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
event MaxUpdatesPerBlockSet(
    uint256 maxUpdatesPerBlock
)
```

Event emitted when max updates per block is set.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `maxUpdatesPerBlock` | `uint256` | new number of max updated per block |

</div>
</div>

<div class="api-node" markdown>

### `StakeConfirmed` { #ev_stakeconfirmed }

<div class="api-node-source" markdown>
Defined in `IPChainStakeMirror` ([Docs](./IPChainStakeMirror.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainStakeMirror.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
event StakeConfirmed(
    address owner,
    bytes20 nodeId,
    bytes32 txHash,
    uint256 amountWei,
    bytes32 pChainTxId
)
```

Event emitted when the stake is confirmed.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `owner` | `address` | The address who opened the stake. |
| `nodeId` | `bytes20` | Node id to which the stake was added. |
| `txHash` | `bytes32` | Unique tx hash - keccak256(abi.encode([`PChainStake`](./PChainStake.md).txId, [`PChainStake`](./PChainStake.md).inputAddress)); |
| `amountWei` | `uint256` | Stake amount (in wei). |
| `pChainTxId` | `bytes32` | P-chain transaction id. |

</div>
</div>

<div class="api-node" markdown>

### `StakeEnded` { #ev_stakeended }

<div class="api-node-source" markdown>
Defined in `IPChainStakeMirror` ([Docs](./IPChainStakeMirror.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainStakeMirror.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
event StakeEnded(
    address owner,
    bytes20 nodeId,
    bytes32 txHash,
    uint256 amountWei
)
```

Event emitted when the stake has ended.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `owner` | `address` | The address whose stake has ended. |
| `nodeId` | `bytes20` | Node id from which the stake was removed. |
| `txHash` | `bytes32` | Unique tx hash - keccak256(abi.encode([`PChainStake`](./PChainStake.md).txId, [`PChainStake`](./PChainStake.md).inputAddress)); |
| `amountWei` | `uint256` | Stake amount (in wei). |

</div>
</div>

<div class="api-node" markdown>

### `StakeRevoked` { #ev_stakerevoked }

<div class="api-node-source" markdown>
Defined in `IPChainStakeMirror` ([Docs](./IPChainStakeMirror.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainStakeMirror.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
event StakeRevoked(
    address owner,
    bytes20 nodeId,
    bytes32 txHash,
    uint256 amountWei
)
```

Event emitted when the stake was revoked.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `owner` | `address` | The address whose stake has ended. |
| `nodeId` | `bytes20` | Node id from which the stake was removed. |
| `txHash` | `bytes32` | Unique tx hash - keccak256(abi.encode([`PChainStake`](./PChainStake.md).txId, [`PChainStake`](./PChainStake.md).inputAddress)); |
| `amountWei` | `uint256` | Stake amount (in wei). |

</div>
</div>

<div class="api-node" markdown>

### `VotePowerCacheCreated` { #ev_votepowercachecreated }

<div class="api-node-source" markdown>
Defined in `IPChainVotePower` ([Docs](./IPChainVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
event VotePowerCacheCreated(
    bytes20 nodeId,
    uint256 blockNumber
)
```

Emitted when a vote power cache entry is created.
Allows history cleaners to track vote power cache cleanup opportunities off-chain.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `nodeId` | `bytes20` | The node id whose vote power has just been cached. |
| `blockNumber` | `uint256` | The block number at which the vote power has been cached. |

</div>
</div>

<div class="api-node" markdown>

### `VotePowerChanged` { #ev_votepowerchanged }

<div class="api-node-source" markdown>
Defined in `IPChainVotePower` ([Docs](./IPChainVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
event VotePowerChanged(
    address owner,
    bytes20 nodeId,
    uint256 priorVotePower,
    uint256 newVotePower
)
```

Event triggered when a stake is confirmed or at the time it ends.
Definition: [`votePowerFromTo`](#fn_votepowerfromto_59c345f5)(owner, nodeId)` is `changed` from `priorVotePower` to `newVotePower`.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `owner` | `address` | The account that has changed the amount of vote power it is staking. |
| `nodeId` | `bytes20` | The node id whose received vote power has changed. |
| `priorVotePower` | `uint256` | The vote power originally on that node id. |
| `newVotePower` | `uint256` | The new vote power that triggered this event. |

</div>
</div>

</div>

<div class="api-node-type" markdown>

## Functions

<div class="api-node" markdown>

### `balanceOf` { #fn_balanceof_70a08231 }

<div class="api-node-source" markdown>
Defined in `IPChainStakeMirror` ([Docs](./IPChainStakeMirror.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainStakeMirror.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function balanceOf(
    address _owner
) external view returns (
    uint256);
```

Queries the token balance of `_owner` at current block.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owner` | `address` | The address from which the balance will be retrieved. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | The current balance. |
</div>
</div>

<div class="api-node" markdown>

### `balanceOfAt` { #fn_balanceofat_4ee2cd7e }

<div class="api-node-source" markdown>
Defined in `IPChainStakeMirror` ([Docs](./IPChainStakeMirror.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainStakeMirror.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function balanceOfAt(
    address _owner,
    uint256 _blockNumber
) external view returns (
    uint256);
```

Queries the token balance of `_owner` at a specific `_blockNumber`.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owner` | `address` | The address from which the balance will be retrieved. |
| `_blockNumber` | `uint256` | The block number when the balance is queried. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | The balance at `_blockNumber`. |
</div>
</div>

<div class="api-node" markdown>

### `batchVotePowerOfAt` { #fn_batchvotepowerofat_a9e70199 }

<div class="api-node-source" markdown>
Defined in `IPChainVotePower` ([Docs](./IPChainVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function batchVotePowerOfAt(
    bytes20[] _nodeIds,
    uint256 _blockNumber
) external view returns (
    uint256[]);
```

Return vote powers for several node ids in a batch.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_nodeIds` | `bytes20[]` | The list of node ids to fetch vote power of. |
| `_blockNumber` | `uint256` | The block number at which to fetch. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256[]` | A list of vote powers. |
</div>
</div>

<div class="api-node" markdown>

### `isActiveStakeMirrored` { #fn_isactivestakemirrored_d9ab4dfe }

<div class="api-node-source" markdown>
Defined in `IPChainStakeMirror` ([Docs](./IPChainStakeMirror.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainStakeMirror.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function isActiveStakeMirrored(
    bytes32 _txId,
    bytes20 _inputAddress
) external view returns (
    bool);
```

Method for checking if active stake (stake start time <= block.timestamp < stake end time) was already mirrored.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_txId` | `bytes32` | P-chain stake transaction id. |
| `_inputAddress` | `bytes20` | P-chain address that opened stake. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `bool` | True if stake is active and mirrored. |
</div>
</div>

<div class="api-node" markdown>

### `mirrorStake` { #fn_mirrorstake_2e335805 }

<div class="api-node-source" markdown>
Defined in `IPChainStakeMirror` ([Docs](./IPChainStakeMirror.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainStakeMirror.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function mirrorStake(
    struct IPChainStakeMirrorVerifier.PChainStake _stakeData,
    bytes32[] _merkleProof
) external;
```

Method for P-chain stake mirroring using [`PChainStake`](./PChainStake.md) data and Merkle proof.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_stakeData` | `struct IPChainStakeMirrorVerifier.PChainStake` | Information about P-chain stake. |
| `_merkleProof` | `bytes32[]` | Merkle proof that should be used to prove the P-chain stake. |

</div>
</div>

<div class="api-node" markdown>

### `stakesOf` { #fn_stakesof_33b69c4c }

<div class="api-node-source" markdown>
Defined in `IPChainVotePower` ([Docs](./IPChainVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function stakesOf(
    address _owner
) external view returns (
    bytes20[] _nodeIds,
    uint256[] _amounts);
```

Get the amounts and node ids being staked to by a vote power owner.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owner` | `address` | The address being queried. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| `_nodeIds` | `bytes20[]` | Array of node ids. |
| `_amounts` | `uint256[]` | Array of staked amounts, for each node id. |
</div>
</div>

<div class="api-node" markdown>

### `stakesOfAt` { #fn_stakesofat_4be91f32 }

<div class="api-node-source" markdown>
Defined in `IPChainVotePower` ([Docs](./IPChainVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function stakesOfAt(
    address _owner,
    uint256 _blockNumber
) external view returns (
    bytes20[] _nodeIds,
    uint256[] _amounts);
```

Get the amounts and node ids being staked to by a vote power owner,
at a given block.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owner` | `address` | The address being queried. |
| `_blockNumber` | `uint256` | The block number being queried. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| `_nodeIds` | `bytes20[]` | Array of node ids. |
| `_amounts` | `uint256[]` | Array of staked amounts, for each node id. |
</div>
</div>

<div class="api-node" markdown>

### `totalSupply` { #fn_totalsupply_18160ddd }

<div class="api-node-source" markdown>
Defined in `IPChainStakeMirror` ([Docs](./IPChainStakeMirror.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainStakeMirror.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function totalSupply(
) external view returns (
    uint256);
```

Total amount of tokens at current block.

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | The current total amount of tokens. |
</div>
</div>

<div class="api-node" markdown>

### `totalSupplyAt` { #fn_totalsupplyat_981b24d0 }

<div class="api-node-source" markdown>
Defined in `IPChainStakeMirror` ([Docs](./IPChainStakeMirror.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainStakeMirror.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function totalSupplyAt(
    uint256 _blockNumber
) external view returns (
    uint256);
```

Total amount of tokens at a specific `_blockNumber`.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_blockNumber` | `uint256` | The block number when the totalSupply is queried. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | The total amount of tokens at `_blockNumber`. |
</div>
</div>

<div class="api-node" markdown>

### `totalVotePower` { #fn_totalvotepower_f5f3d4f7 }

<div class="api-node-source" markdown>
Defined in `IPChainVotePower` ([Docs](./IPChainVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function totalVotePower(
) external view returns (
    uint256);
```

Get the current total vote power.

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | The current total vote power (sum of all accounts' vote powers). |
</div>
</div>

<div class="api-node" markdown>

### `totalVotePowerAt` { #fn_totalvotepowerat_3e5aa26a }

<div class="api-node-source" markdown>
Defined in `IPChainVotePower` ([Docs](./IPChainVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function totalVotePowerAt(
    uint256 _blockNumber
) external view returns (
    uint256);
```

Get the total vote power at block `_blockNumber`

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_blockNumber` | `uint256` | The block number at which to fetch. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | The total vote power at the block  (sum of all accounts' vote powers). |
</div>
</div>

<div class="api-node" markdown>

### `totalVotePowerAtCached` { #fn_totalvotepoweratcached_caeb942b }

<div class="api-node-source" markdown>
Defined in `IPChainVotePower` ([Docs](./IPChainVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function totalVotePowerAtCached(
    uint256 _blockNumber
) external returns (
    uint256);
```

Get the total vote power at block `_blockNumber` using cache.
  It tries to read the cached value and if not found, reads the actual value and stores it in cache.
  Can only be used if `_blockNumber` is in the past, otherwise reverts.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_blockNumber` | `uint256` | The block number at which to fetch. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | The total vote power at the block (sum of all accounts' vote powers). |
</div>
</div>

<div class="api-node" markdown>

### `votePowerFromTo` { #fn_votepowerfromto_59c345f5 }

<div class="api-node-source" markdown>
Defined in `IPChainVotePower` ([Docs](./IPChainVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function votePowerFromTo(
    address _owner,
    bytes20 _nodeId
) external view returns (
    uint256);
```

Get current staked vote power from `_owner` staked to `_nodeId`.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owner` | `address` | Address of vote power owner. |
| `_nodeId` | `bytes20` | Node id. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | The staked vote power. |
</div>
</div>

<div class="api-node" markdown>

### `votePowerFromToAt` { #fn_votepowerfromtoat_1f7ff2c7 }

<div class="api-node-source" markdown>
Defined in `IPChainVotePower` ([Docs](./IPChainVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function votePowerFromToAt(
    address _owner,
    bytes20 _nodeId,
    uint256 _blockNumber
) external view returns (
    uint256);
```

Get current staked vote power from `_owner` staked to `_nodeId` at `_blockNumber`.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owner` | `address` | Address of vote power owner. |
| `_nodeId` | `bytes20` | Node id. |
| `_blockNumber` | `uint256` | The block number at which to fetch. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | The staked vote power. |
</div>
</div>

<div class="api-node" markdown>

### `votePowerOf` { #fn_votepowerof_b4eb2a81 }

<div class="api-node-source" markdown>
Defined in `IPChainVotePower` ([Docs](./IPChainVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function votePowerOf(
    bytes20 _nodeId
) external view returns (
    uint256);
```

Get the current vote power of `_nodeId`.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_nodeId` | `bytes20` | The node id to get voting power. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | Current vote power of `_nodeId`. |
</div>
</div>

<div class="api-node" markdown>

### `votePowerOfAt` { #fn_votepowerofat_46431374 }

<div class="api-node-source" markdown>
Defined in `IPChainVotePower` ([Docs](./IPChainVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function votePowerOfAt(
    bytes20 _nodeId,
    uint256 _blockNumber
) external view returns (
    uint256);
```

Get the vote power of `_nodeId` at block `_blockNumber`

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_nodeId` | `bytes20` | The node id to get voting power. |
| `_blockNumber` | `uint256` | The block number at which to fetch. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | Vote power of `_nodeId` at `_blockNumber`. |
</div>
</div>

<div class="api-node" markdown>

### `votePowerOfAtCached` { #fn_votepowerofatcached_bd61ffee }

<div class="api-node-source" markdown>
Defined in `IPChainVotePower` ([Docs](./IPChainVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/userInterfaces/IPChainVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function votePowerOfAtCached(
    bytes20 _owner,
    uint256 _blockNumber
) external returns (
    uint256);
```

Get the vote power of `_owner` at block `_blockNumber` using cache.
  It tries to read the cached value and if not found, reads the actual value and stores it in cache.
  Can only be used if _blockNumber is in the past, otherwise reverts.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owner` | `bytes20` | The node id to get voting power. |
| `_blockNumber` | `uint256` | The block number at which to fetch. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | Vote power of `_owner` at `_blockNumber`. |
</div>
</div>

</div>

