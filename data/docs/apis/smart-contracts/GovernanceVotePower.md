---
title: GovernanceVotePower
search:
  boost: 0.5
---

<!-- This is an autogenerated file. Do not edit! -->

# `GovernanceVotePower` { #ct_governancevotepower }

<div class="api-node-source" markdown>
[Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol) | Inherits from [IIGovernanceVotePower](./IIGovernanceVotePower.md)
</div>

<div class="api-node-internal" markdown>

Contract managing governance vote power and its delegation.

</div>

<div class="api-node-type" markdown>

## Functions

<div class="api-node" markdown>

### `constructor` { #fn_constructor_undefined }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
constructor(
    contract IVPToken _ownerToken,
    contract IPChainStakeMirror _pChainStakeMirror
) public;
```

Construct [`GovernanceVotePower`](./GovernanceVotePower.md) for given [`VPToken`](./VPToken.md).

</div>
</div>

<div class="api-node" markdown>

### `delegate` { #fn_delegate_5c19a95c }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function delegate(
    address _to
) public;
```

Delegates all governance vote power of `msg.sender` to address `_to`.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_to` | `address` | The address of the recipient. |

</div>
</div>

<div class="api-node" markdown>

### `delegatedGovernanceVotePowerHistoryCleanup` { #fn_delegatedgovernancevotepowerhistorycleanup_29a59ff2 }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function delegatedGovernanceVotePowerHistoryCleanup(
    address _owner,
    uint256 _count
) external returns (
    uint256);
```

Delete governance vote power checkpoints that expired (i.e. are before `cleanupBlockNumber`).
Method can only be called from the [`cleanerContract`](#va_cleanercontract) (which may be a proxy to external cleaners).

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owner` | `address` | Vote power owner account address. |
| `_count` | `uint256` | Maximum number of checkpoints to delete. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | The number of deleted checkpoints. |
</div>
</div>

<div class="api-node" markdown>

### `delegatesHistoryCleanup` { #fn_delegateshistorycleanup_f7ce0ddf }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function delegatesHistoryCleanup(
    address _owner,
    uint256 _count
) external returns (
    uint256);
```

Delete delegates checkpoints that expired (i.e. are before `cleanupBlockNumber`).
Method can only be called from the [`cleanerContract`](#va_cleanercontract) (which may be a proxy to external cleaners).

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_owner` | `address` | Vote power owner account address. |
| `_count` | `uint256` | Maximum number of checkpoints to delete. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | The number of deleted checkpoints. |
</div>
</div>

<div class="api-node" markdown>

### `getCleanupBlockNumber` { #fn_getcleanupblocknumber_a72ec4b6 }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function getCleanupBlockNumber(
) external view returns (
    uint256);
```

Get the current cleanup block number set with [`setCleanupBlockNumber`](#fn_setcleanupblocknumber_13de97f5).

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | The currently set cleanup block number. |
</div>
</div>

<div class="api-node" markdown>

### `getDelegateOfAt` { #fn_getdelegateofat_3c028e9d }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function getDelegateOfAt(
    address _who,
    uint256 _blockNumber
) public view returns (
    address);
```

Gets the address an account is delegating its governance vote power to, at a given block number.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_who` | `address` | The address being queried. |
| `_blockNumber` | `uint256` | The block number at which to fetch the address. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `address` | Address where `_who` was delegating its governance vote power at block `_blockNumber`. |
</div>
</div>

<div class="api-node" markdown>

### `getDelegateOfAtNow` { #fn_getdelegateofatnow_b3e871ee }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function getDelegateOfAtNow(
    address _who
) public view returns (
    address);
```

Gets the address an account is delegating its governance vote power to, at the latest block number.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_who` | `address` | The address being queried. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `address` | Address where `_who` is currently delegating its governance vote power. |
</div>
</div>

<div class="api-node" markdown>

### `getVotes` { #fn_getvotes_9ab24eb0 }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function getVotes(
    address _who
) public view returns (
    uint256);
```

Gets the governance vote power of an address at the latest block, including
all delegations made to it.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_who` | `address` | The address being queried. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | Governance vote power of `account` at the lastest block. |
</div>
</div>

<div class="api-node" markdown>

### `ownerToken` { #fn_ownertoken_65371883 }

<div class="api-node-source" markdown>
Defined in `IIGovernanceVotePower` ([Docs](./IIGovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/interface/IIGovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function ownerToken(
) external view returns (
    contract IVPToken);
```

Get the token that this governance vote power contract belongs to.

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `contract IVPToken` | The [`IVPToken`](./IVPToken.md) interface owning this contract. |
</div>
</div>

<div class="api-node" markdown>

### `pChainStakeMirror` { #fn_pchainstakemirror_62d9c89a }

<div class="api-node-source" markdown>
Defined in `IIGovernanceVotePower` ([Docs](./IIGovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/interface/IIGovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function pChainStakeMirror(
) external view returns (
    contract IPChainStakeMirror);
```

Get the stake mirror contract that this governance vote power contract belongs to.

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `contract IPChainStakeMirror` | The [`IPChainStakeMirror`](./IPChainStakeMirror.md) interface owning this contract. |
</div>
</div>

<div class="api-node" markdown>

### `setCleanerContract` { #fn_setcleanercontract_f6a494af }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function setCleanerContract(
    address _cleanerContract
) external;
```

Set the contract that is allowed to call history cleaning methods.

This method can be called by the [`ownerToken`](#va_ownertoken) only.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_cleanerContract` | `address` | Address of the cleanup contract. Usually this will be an instance of [`CleanupBlockNumberManager`](./CleanupBlockNumberManager.md). |

</div>
</div>

<div class="api-node" markdown>

### `setCleanupBlockNumber` { #fn_setcleanupblocknumber_13de97f5 }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function setCleanupBlockNumber(
    uint256 _blockNumber
) external;
```

Set the cleanup block number.
Historic data for the blocks before `cleanupBlockNumber` can be erased.
History before that block should never be used since it can be inconsistent.
In particular, cleanup block number must be lower than the current vote power block.

This method can be called by the [`ownerToken`](#va_ownertoken) only.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_blockNumber` | `uint256` | The new cleanup block number. |

</div>
</div>

<div class="api-node" markdown>

### `undelegate` { #fn_undelegate_92ab89bb }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function undelegate(
) public;
```

Undelegates all governance vote power of `msg.sender`.

</div>
</div>

<div class="api-node" markdown>

### `updateAtTokenTransfer` { #fn_updateattokentransfer_eadb4362 }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function updateAtTokenTransfer(
    address _from,
    address _to,
    uint256,
    uint256,
    uint256 _amount
) external;
```

Update governance vote power of all involved delegates after tokens are transferred.

This function **MUST** be called after each governance token transfer for the
delegates to reflect the correct balance.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_from` | `address` | Source address of the transfer. |
| `_to` | `address` | Destination address of the transfer. |
| `` | `uint256` |  |
| `` | `uint256` |  |
| `_amount` | `uint256` | Amount being transferred. |

</div>
</div>

<div class="api-node" markdown>

### `votePowerOfAt` { #fn_votepowerofat_92bfe6d8 }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
function votePowerOfAt(
    address _who,
    uint256 _blockNumber
) public view returns (
    uint256);
```

Gets the governance vote power of an address at a given block number, including
all delegations made to it.

| Parameters | Type | Description |
| ---------- | ---- | ----------- |
| `_who` | `address` | The address being queried. |
| `_blockNumber` | `uint256` | The block number at which to fetch the vote power. |

| Returns | Type | Description |
| ------- | ---- | ----------- |
| [0] | `uint256` | Governance vote power of `_who` at `_blockNumber`. |
</div>
</div>

</div>

<div class="api-node-type" markdown>

## Modifiers

<div class="api-node" markdown>

### `onlyCleaner` { #md_onlycleaner }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
modifier onlyCleaner()
```

History cleaning methods can be called only from the cleaner address.

</div>
</div>

<div class="api-node" markdown>

### `onlyOwnerContracts` { #md_onlyownercontracts }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
modifier onlyOwnerContracts()
```

Method [`updateAtTokenTransfer`](#fn_updateattokentransfer_eadb4362) in [`GovernanceVotePower`](./GovernanceVotePower.md) can only be executed by the owner contracts.

</div>
</div>

<div class="api-node" markdown>

### `onlyOwnerToken` { #md_onlyownertoken }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
modifier onlyOwnerToken()
```

All external methods in [`GovernanceVotePower`](./GovernanceVotePower.md) can only be executed by the owner token.

</div>
</div>

</div>

<div class="api-node-type" markdown>

## Variables

<div class="api-node" markdown>

### `cleanerContract` { #va_cleanercontract }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
    address cleanerContract
```

Address of the contract that is allowed to call methods for history cleaning.
Set with [`setCleanerContract`](#fn_setcleanercontract_f6a494af).

</div>
</div>

<div class="api-node" markdown>

### `ownerToken` { #va_ownertoken }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
    contract IVPToken ownerToken
```

The [`VPToken`](./VPToken.md) and [`IPChainStakeMirror`](./IPChainStakeMirror.md) contracts that own this [`GovernanceVotePower`](./GovernanceVotePower.md).
All state changing methods may be called only from these addresses.
This is because original `msg.sender` is typically sent in a parameter
and we must make sure that it cannot be faked by directly calling
[`GovernanceVotePower`](./GovernanceVotePower.md) methods.

</div>
</div>

<div class="api-node" markdown>

### `pChainStakeMirror` { #va_pchainstakemirror }

<div class="api-node-source" markdown>
Defined in `GovernanceVotePower` ([Docs](./GovernanceVotePower.md), [Source](https://gitlab.com/flarenetwork/flare-smart-contracts/-/tree/master/contracts/token/implementation/GovernanceVotePower.sol)).
</div>

<div class="api-node-internal" markdown>

```solidity
    contract IPChainStakeMirror pChainStakeMirror
```

Get the stake mirror contract that this governance vote power contract belongs to.

| Returns | Type | Description |
| ------- | ---- | ----------- |
</div>
</div>

</div>

